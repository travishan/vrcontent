function img_error(e){var t="/image/defaultAvatar.png",i="/image/defaultCourse.png",a=$(e).attr("errorsrc");1==a?$(e).attr("src",t):$(e).attr("src",i),$(e).removeAttr("onerror")}function imgError_1(e){$(e).attr("src",$(e).attr("orginal_img")),$(e).removeAttr("onerror")}!function(e,t){e.baseDir=function(){},e.baseDir.prototype.getRootPath=function(){var e=gxb.settings.env.getContextPath();return e+"/js/dirViews"},e.baseDir.prototype.resolvePath=function(e){return this.getRootPath()+e+".html"},e.baseDir.prototype.resolveCommonDirectivePath=function(e){return this.getRootPath()+"/01-common_directives"+e+".html"},e.baseDir.prototype.resolveDefaultTemplatePath=function(e){return this.getRootPath()+"/02-default-template"+e+".html"},e.baseDir.prototype.resolveSecondTemplatePath=function(e){return this.getRootPath()+"/03-second-template"+e+".html"},e.baseDir.prototype.resolveUrl=function(e){return t.urlUtils.resolveUrl(e)}}(gxb.directives,gxb.utils),function(e){e.registerNamespace("gxb.directives.uis"),e.registerNamespace("gxb.directives.uis.card"),e.registerNamespace("gxb.directives.uis.page")}(gxb.components),function(e,t){e.uis.authDir=function(e){return{restrict:"E",templateUrl:this.resolveCommonDirectivePath("/authentication/authentication"),replace:!0,scope:{data:"=data"},controller:["$scope","$element",function(t,i){function a(){e.$userSrv.noRepeatLoad().then(function(e){t.repeatNum=e.data||""})}function n(){var e=$(".gxb-studentId-input input").val().trim();return $(".gxb-studentId-ul").find("li").each(function(){$(this).css("display","block"),$(".gxb-noschool-search").css("display","none")}),e.length>0&&($(".gxb-studentId-ul li").addClass("haveClass"),$(".gxb-studentId-ul li").each(function(){var t=$(this).text().substring(0,$(this).text().length).toLowerCase();t.indexOf(e.toLowerCase())!=-1&&"teacher"!=$(this).attr("shortname")||($(this).css("display","none"),$(this).removeClass("haveClass"))})),$(".gxb-studentId-ul li").hasClass("haveClass")?$(".gxb-noschool-search").css("display","none"):$(".gxb-noschool-search").css("display","block"),0==e.length&&($(".gxb-noschool-search").css("display","none"),$(".gxb-studentId-ul li").css("display","none")),!1}var r=gxb.settings.identifier.getTenantID();e.$userSrv.getSchool().then(function(e){t.schoolListData=e.data||[],$.each(e.data,function(e,t){t.tenantId==r&&$(".gxb-school").val(t.name).attr("tenantId",t.tenantId)}),t.$apply()}),$(".gxb-studentId-school").click(function(e){e.stopPropagation(),$(".gxb-studentId-list").toggle(),$(".gxb-studentId-input input").val(""),$(".gxb-studentId-ul").find("li").each(function(){$(this).css("display","none"),$(".gxb-noschool-search").css("display","none")})}),$(document).click(function(){$(".gxb-studentId-list").hide()}),a();var s=[],o=0;$(".gxb-studentId-input input").unbind("keydown"),$(".gxb-studentId-input input").on("keydown",function(e){e.stopPropagation(),setTimeout(function(){n(),s=[],$(".gxb-studentId-sch").find("li").each(function(){"block"==$(this).css("display")&&s.push($(this).attr("tenantid"))})},500);var t=e.keyCode;if(40==t){o>=s.length&&(o=0),o++;var i=s[o-1];$(".gxb-studentId-sch").find("li").each(function(){$(this).attr("tenantid")==i&&($(this).addClass("cur").siblings().removeClass("cur"),$(".gxb-school").val($(this).text()))})}if(38==t){o<=1&&(o=s.length+1),o--;var i=s[o-1];$(".gxb-studentId-sch").find("li").each(function(){$(this).attr("tenantid")==i&&($(this).addClass("cur").siblings().removeClass("cur"),$(".gxb-school").val($(this).text()))})}13==t&&$(".gxb-studentId-sch li.cur").click()}),$(".gxb-studentId-input input").on("click",function(e){e.stopPropagation()}),t.getTenantId=function(e,t){$(".gxb-studentId-list").hide(),$(".gxb-school").val(t).attr("tenantId",e)};t.$watch("data.isShow",function(){t.Bomb=t.data.isShow});t.tenantID=!1,t.studentNo=!1,t.studentName=!1,t.underway=!0,t.success=!1,t.wrong=!0;var l=!0;t.wrongMessage=!0,t.submitAuth=function(){var i=$(".gxb-school").attr("tenantId"),n=t.no,r=t.name;if(i?t.tenantID=!1:t.tenantID=!0,n?t.studentNo=!1:t.studentNo=!0,r?t.studentName=!1:t.studentName=!0,i&&n&&r&&l){var s={name:r,no:n,tenantId:i};l=!1,gxb.utils.localStorageUtils.get("repeat_token")&&""!=gxb.utils.localStorageUtils.get("repeat_token")&&(t.repeatNum=gxb.utils.localStorageUtils.get("repeat_token")),e.$userSrv.bindingStudent(s,t.repeatNum).then(function(e){a(),l=!0,e.status&&(t.underway=!1,t.success=!0),e.status||(t.underway=!0,t.success=!1,t.wrong=!1,t.wrongMessage=!0),t.$apply()},function(e){l=!0,t.underway=!0,t.success=!1,t.wrong=!1,t.wrongMessage=!1,t.faildSay=e.msg||"",a(),t.$apply()})}},t.close=function(){t.Bomb=t.data.isShow=!1},t.startLearn=function(){t.data.classId?e.$userSrv.courseState(t.data.classId).then(function(i){if(0==i&&(window.location.href=gxb.settings.identifier.goLMS()+"/class/"+t.data.classId+"/unit"),6==i||"-1"==i){var a={classId:t.data.classId};e.$userSrv.startLearning(a).then(function(e){e>0?window.location.href=gxb.settings.identifier.goLMS()+"/class/"+t.data.classId+"/unit":gxb.settings.identifier.goLoginUrl()})}5!=i&&4!=i&&3!=i&&2!=i&&7!=i||window.location.reload()}):(t.Bomb=!t.Bomb,window.location.href=gxb.utils.urlUtils.resolveUrl("#/user/user_my?tab=2"),window.location.reload())},t.changevalue=function(e){t.wrong=!0,"studentNumber"==e&&(t.no?t.studentNo=!1:t.studentNo=!0),"student"==e&&(t.name?t.studentName=!1:t.studentName=!0)}}]}},e.inheritFromDir(e.uis.authDir),e.registerDirective("gxbauth","gxb.directives.uis.authDir",["$compile","$interval","gxb.services.classes.userSrv"])}(gxb.directives,gxb.utils),function(e,t){e.uis.dateRangeDir=function(e){var t=function(e,t,i){var a="";a+='<div class="btn btn-circle blue">',a+='\t<i class="fa fa-calendar"></i> &nbsp; <span> '+moment().subtract("days",29).format("D MMMM, YYYY")+" - "+moment().format("D MMMM, YYYY")+' </span> <b class="fa fa-angle-down"></b>',a+="</div>",$(t).html(a);var n=$(t).find("div").get(0),r={opens:Metronic.isRTL()?"left":"right",startDate:moment().subtract("days",29),endDate:moment(),minDate:e[i.min],maxDate:e[i.max],dateLimit:{days:e[i.limit]},showDropdowns:!0,showWeekNumbers:!1,timePicker:!1,timePickerIncrement:1,timePicker12Hour:!0,ranges:{},buttonClasses:["btn"],applyClass:"green-jungle",cancelClass:"red-intense",format:"MM/DD/YYYY",separator:" até ",locale:{applyLabel:"确定",cancelLabel:"取消",fromLabel:"从",toLabel:"到",customRangeLabel:"Selecionar período",daysOfWeek:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],monthNames:["一月","Fevereiro","Março","Abril","Maio","Junho","July","Agosto","Setembro","Outubro","Novembro","Dezembro"],firstDay:1}},s=function(t,a){e[i.bind].startDate=t.format("D/MM/YYYY"),e[i.bind].endDate=a.format("D/MM/YYYY"),$($(n).find("span").get(0)).html(t.format("D MMMM, YYYY")+" - "+a.format("D MMMM, YYYY"))};$(n).daterangepicker(r,s)};return{restrict:"E",link:t}},e.inheritFromDir(e.uis.dateRangeDir),e.registerDependency("gxb.directives.uis.dateRangeDir",[]),e.registerDirective("gxbdaterange","gxb.directives.uis.dateRangeDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.ellipsis=function(e){return{restrict:"A",scope:{ngBind:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@"},compile:function(){return function(e,t,i){function a(){"undefined"!=typeof e.ngBind&&t.html(e.ngBind),t.css({"word-wrap":"break-word",overflow:"hidden"});var a=i.rowsCount||1;if(a>1){var n=$(t[0]),r=n.text().split("").reverse(),s="undefined"!=typeof i.ellipsisSymbol?i.ellipsisSymbol:"&hellip;";"undefined"!=typeof e.ellipsisAppend&&""!==e.ellipsisAppend?s+"<span>"+e.ellipsisAppend+"</span>":s;n.html("");var o=n.css("height");n.css("height","initial"),n.html("高");var l=n.css("display");gxb.utils.browserUtils.ie&&n.css("display","inline");var c=1*parseInt(n.css("padding-top"))||0,u=n.height()-c,d=0;if(gxb.utils.browserUtils.ie){var g=1*parseInt(n.css("line-height"))||0;u=g||u,d=u-g}n.html("");for(var p="",m=n.height();m<=u*a&&r.length;)p+=r.pop(),n.html(p),m=n.height()-c+d;1*parseInt(o)?n.css("height",o):n.css("height",""),gxb.utils.browserUtils.ie&&n.css("display",l),r.length&&n.html(p.substr(0,p.length-2)+s)}else t.css({overflow:"hidden","text-overflow":"ellipsis","-webkit-line-clamp":i.rowsCount||1,"-webkit-box-orient":"vertical",display:"-webkit-box"})}e.$watch("ngBind",function(){a()})}}}},e.inheritFromDir(e.uis.ellipsis),e.registerDependency("gxb.directives.uis.ellipsis",[]),e.registerDirective("gxbellipsis","gxb.directives.uis.ellipsis",["$compile","$interval","$timeout","$window"])}(gxb.directives,gxb.utils),function(e,t){e.uis.imgerrorDir=function(e){return{restrict:"A",scope:{gxbimgerror:"=gxbimgerror"},controller:["$scope",function(e){e.image=e.gxbimgerror}],link:function(e,t,i){var a=$(t[0]);a.attr("src",e.image),a.attr("onerror","img_error(this)")}}},e.inheritFromDir(e.uis.imgerrorDir),e.registerDependency("gxb.directives.uis.imgerrorDir",[]),e.registerDirective("gxbimgerror","gxb.directives.uis.imgerrorDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.editorDir=function(e){var i=null;return{restrict:"E",templateUrl:this.resolveCommonDirectivePath("/richeditor/richeditor"),replace:!0,scope:{data:"=data"},compile:function(e,i,a){e.attr("id","uploader_"+t.generateID())},controller:["$scope","$element",function(a,n){var r=null,s=a.data||{content:"",size:{width:"100%",height:"100%"}};a.selectorID="ueditor_"+t.generateID();var o=function(){"undefined"!=typeof UE&&$("#"+a.selectorID).length&&(r=UE.getEditor(a.selectorID),r.ready(function(){a.uploadData={fileElementID:".edui-for-simpleupload",isImage:!0,autoupload:!0,cdnPrefix:gxb.settings.cdn.wangsu.getPaths().rich_attach_prefix,cdnBucket:gxb.settings.cdn.wangsu.getBuckets().defaultBucket,onSuccess:function(e){r.focus(),r.execCommand("inserthtml",'<img style="width: 100%;height: auto;margin:0 auto;"  src="'+e.absoluteUrl+'"  >')}},a.uploadAttachment={fileElementID:".edui-for-treesea",isAll:!0,autoupload:!0,cdnPrefix:gxb.settings.cdn.wangsu.getPaths().rich_attach_prefix,cdnBucket:gxb.settings.cdn.wangsu.getBuckets().defaultBucket,onProgress:function(e){if(console.log(e),document.getElementById("_upload_process_content"))document.getElementById("_upload_process_content").innerHTML="正在上传..."+100*e.percentage+"%";else{var t=document.createElement("div"),i=document.createElement("div");t.style.cssText="height: 100%; width: 100%; position: fixed; top: 0; left: 0; z-index: 9999; background: rgba(40,59,92,.4);",t.id="_upload_process_mask",i.style.cssText="width: 460px; color:#fff;text-align: center; position: absolute; top: 50%; left: 50%; margin-top: -140px; margin-left: -230px; background: green;",i.id="_upload_process_content",i.innerHTML="正在上传..."+100*e.percentage+"%",t.appendChild(i),document.body.appendChild(t)}},onSuccess:function(e){var t=document.getElementById("_upload_process_mask");t&&t.parentNode.removeChild(t),r.focus(),r.execCommand("inserthtml",'&nbsp;<a  href="'+e.absoluteUrl+'"  target="_blank">'+e.file.name+"</a>&nbsp;")}},r.setContent(s.content||""),r.addListener("contentChange",function(){s.content=r.getContent(),s.onContentChanged&&s.onContentChanged(r.getContentTxt())}),a.$apply()}),e.$interval.cancel(i))};s.manualChange=o,"undefined"==typeof UE?t.loaderUtils.jsLoader([t.pathUtils.concatLocalJSPath("/uedit/ueditor.config.js"),t.pathUtils.concatLocalJSPath("/uedit/ueditor.all.min.js")],function(){i=e.$interval(o,10)}):i=e.$interval(o,10)}]}},e.inheritFromDir(e.uis.editorDir),e.registerDirective("gxbeditor","gxb.directives.uis.editorDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.slideDir=function(e){return{restrict:"A",scope:{gxbslider:"=gxbslider"},controller:["$scope",function(e){e.sidelImage=e.gxbslider}],link:function(e,t,i){var a=$(t[0]),n=e.sidelImage.substring(0,e.sidelImage.lastIndexOf("."))+"_"+i.dimension+e.sidelImage.substring(e.sidelImage.lastIndexOf("."));a.attr("src",n),a.attr("orginal_img",e.sidelImage),a.attr("onerror","imgError_1(this)")}}},e.inheritFromDir(e.uis.slideDir),e.registerDependency("gxb.directives.uis.slideDir",[]),e.registerDirective("gxbslider","gxb.directives.uis.slideDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.sortableDir=function(e){"use strict";function t(t){var i=angular.element(t).scope(),a=[].filter.call(t.childNodes,function(e){return 8===e.nodeType&&e.nodeValue.indexOf("ngRepeat:")!==-1})[0];a=a.nodeValue.match(/ngRepeat:\s*(?:\(.*?,\s*)?([^\s)]+)[\s)]+in\s+([^\s|]+)/);var n=e.$parse(a[1]),r=e.$parse(a[2]);return{item:function(e){return n(angular.element(e).scope())},items:function(){return r(i)}}}var i;return{restrict:"AC",link:function(e,a,n){function r(a){var n=a.oldIndex,r=a.newIndex,s=u.items();if(o!==a.from){var l=t(a.from),c=l.items();n=c.indexOf(l.item(a.item)),i=c.splice(n,1)[0],s.splice(r,0,i),a.from.appendChild(a.item)}else s.splice(r,0,s.splice(n,1)[0]);e.$apply()}var s,o=a[0],l=n.gxbsortable,c=e.$eval(l)||{},u=t(o);"Start End Add Update Remove Sort".split(" ").forEach(function(e){c["on"+e]=c["on"+e]||function(){}}),s=Sortable.create(o,Object.keys(c).reduce(function(e,t){return e[t]=e[t]||c[t],e},{onStart:function(){c.onStart(u.items())},onEnd:function(e){c.onEnd(e,u.items())},onAdd:function(e){r(e),c.onAdd(u.items(),i)},onUpdate:function(e){r(e),c.onUpdate(u.items(),u.item(e.item))},onRemove:function(){c.onRemove(u.items(),i)},onSort:function(){c.onSort(u.items())}})),a.on("$destroy",function(){s.destroy(),s=null}),/{|}/.test(l)||angular.forEach(["sort","disabled","draggable","handle","animation"],function(t){e.$watch(l+"."+t,function(e){void 0!==e&&(c[t]=e,s.option(t,e))})})}}},e.inheritFromDir(e.uis.sortableDir),e.registerDirective("gxbsortable","gxb.directives.uis.sortableDir",["$compile","$parse"])}(gxb.directives,gxb.utils),function(e,t){e.uis.starDir=function(e){return{restrict:"E",templateUrl:this.resolveCommonDirectivePath("/star/star"),scope:{ratingValue:"=",max:"=",readonly:"@",onHover:"=",onLeave:"="},controller:["$scope",function(e){e.ratingValue=e.ratingValue||0,e.max=e.max||5,e.click=function(t){e.readonly&&"true"===e.readonly||(e.ratingValue=t)},e.over=function(t){e.onHover&&e.onHover(t)},e.leave=function(){e.onLeave&&e.onLeave()}}],link:function(e,t,i){t.css("text-align","center");var a=function(){e.stars=[];for(var t=0;t<e.max;t++)e.stars.push({filled:t<e.ratingValue})};a(),e.$watch("ratingValue",function(e,t){t&&a()}),e.$watch("max",function(e,t){t&&a()})}}},e.inheritFromDir(e.uis.starDir),e.registerDependency("gxb.directives.uis.starDir",[]),e.registerDirective("gxbstar","gxb.directives.uis.starDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.tenantPicker=function(e){return{restrict:"E",templateUrl:this.resolveCommonDirectivePath("/tenantpicker/picker"),replace:!0,compile:function(e,i,a){e.attr("id","tenant_picker_"+t.generateID())},scope:{data:"=data"},controller:["$scope","$element",function(t,i){t.showOrHideTenantListView=!1,t.data=t.data||{},t.hasMulti=t.data.hasMulti||!1,t.tenants=[],t.selectedTenant=null,t.selectedTenants=t.data.checkedTenant||[];var a=function(e){for(var i=!1,a=0,n=t.selectedTenants.length;a<n;a++){var r=t.selectedTenants[a];if(e.id==r.id){i=!0;break}}i||t.selectedTenants.push(e)};t.isHide=function(e){e.stopPropagation(),"none"===$(".tenant-picker-tenantbox").css("display")?$(".tenant-picker-tenantbox").show():$(".tenant-picker-tenantbox").hide()},t.filterName=function(e){e.stopPropagation()};var n=function(e){for(var i=[],a=0,n=t.selectedTenants.length;a<n;a++){var r=t.selectedTenants[a];e.id!=r.id&&i.push(r)}t.selectedTenants=i};e.$studentListSrv.tenantDataList(1,1e4).then(function(e){t.tenants=[],$.each(e.dataList||[],function(e,i){"online"==i.status&&(t.tenants.push(i),t.data.DEFAULT_TENANT_ID+""==i.id&&(t.selectedTenant=i))}),t.list=t.tenants||[]});var r=function(){for(var e=[],i=0,a=t.selectedTenants.length;i<a;i++){var n=t.selectedTenants[i];e.push({id:n.id,name:n.name})}t.data.onChanged&&t.data.onChanged(e)};t.pickerTenant=function(e){$(".tenant-picker-tenantbox").hide(),t.hasMulti?(a(e),r()):(t.selectedTenant=e,t.data.onChanged&&t.data.onChanged(e.name||"",e.id||""))},t.remove=function(e,i){i.stopPropagation(),t.hasMulti&&(n(e),r())};t.$watch("data.checkedTenant",function(){t.selectedTenants=t.data.checkedTenant});$(document).click(function(){$(".tenant-picker-tenantbox").hide()})}]}},e.inheritFromDir(e.uis.tenantPicker),e.registerDirective("gxbtenantfilter","gxb.directives.uis.tenantPicker",["gxb.services.tenants.studentListSrv"])}(gxb.directives,gxb.utils),function(e,t){e.uis.uploaderDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveCommonDirectivePath("/uploader/uploader"),replace:!0,scope:{data:"=data"},compile:function(e,i,a){e.attr("id","uploader_"+t.generateID())},controller:["$scope","$element",function(a,n){!function(){a.__={};var n=null,r=(a.data,a.data.cdnPrefix||""),s=a.data.cdnBucket||"gxb-file";a.selectorID="fileselector_"+t.generateID(),a.__.uploader=null;var o=null,l=null;a.onUpload=function(){if(a.__.uploader&&o){var e={filename:o.name,filesize:o.size,filetype:"application/octet-stream"==o.type?"":o.type,prefix:r,bucket:s};t.ajaxUtils.doPost({url:i.resolveUrl("/cdn/signature/api"),data:e,dataType:"text"}).then(function(e){l=e,a.__.uploader.options.server=e,a.__.uploader.options.sendAsBinary=!0,a.__.uploader.options.method="PUT",a.__.uploader.options.headers={"x-amz-acl":"public-read"},a.__.uploader.upload()})}};var c=a.data.fileElementID||a.selectorID;0!==c.indexOf(".")&&(c="#"+c);var u=function(){"undefined"!=typeof WebUploader&&(a.__.uploader=WebUploader.create({auto:!1,swf:i.resolvePath("/uploader/Uploader.swf"),server:"",pick:c,resize:!1,accept:a.data.isImage?{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/gif,image/jpeg,image/png,image/jpg,image/bmp"}:{}}),a.__.uploader.on("fileQueued",function(e){a.data.onQueued&&a.data.onQueued(e),o=e,a.data.autoupload&&a.onUpload()}),a.__.uploader.on("uploadProgress",function(e,t){console.log(100*t+"%"),a.data.onProgress&&a.data.onProgress({file:e,percentage:t})}),a.__.uploader.on("uploadSuccess",function(e){a.data.onSuccess&&a.data.onSuccess({file:e,absoluteUrl:t.urlUtils.getRemoteUrl(l),relativeUrl:"/"+r+"/"+t.urlUtils.getCDNFile(l)});var n=a.data;if(n.cutImage){var s=n.cdnPrefix||"",o=n.cdnBucket||"gxb-file",c={filename:"/"+s+"/"+t.urlUtils.getCDNFile(l),bucket:o,size:n.size||[]};t.ajaxUtils.doPost({url:i.resolveUrl("/cdn/cutimage/api"),data:c,dataType:"text"}).then(function(){console.log("转码成功！")},function(){console.log("转码失败！")})}}),a.__.uploader.on("uploadError",function(e){console.log("error"),a.data.onError&&a.data.onError(e)}),a.__.uploader.on("uploadComplete",function(e){a.data.onComplete&&a.data.onComplete(e)}),e.$interval.cancel(n))};"undefined"==typeof WebUploader?t.loaderUtils.jsLoader([t.pathUtils.concatLocalJSPath("/uploader/webuploader.min.js")],function(){n=e.$interval(u,10)}):u()}()}]}},e.inheritFromDir(e.uis.uploaderDir),e.registerDirective("gxbuploader","gxb.directives.uis.uploaderDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.videoDir=function(e){return{restrict:"E",templateUrl:this.resolveCommonDirectivePath("/video/video"),replace:!0,require:"data",compile:function(e,i,a){e.attr("id","video_"+t.generateID())},controller:["$scope","$element",function(i,a){new gxb.directives.uis._videoController(t.objectUtils.extend({videoElementId:a.attr("id")},i.data||{}),e)}]}},e.inheritFromDir(e.uis.videoDir),e.registerDirective("gxbvideo","gxb.directives.uis.videoDir",["$compile","$interval","gxb.services.classes.classesSrv"])}(gxb.directives,gxb.utils),function(e,t){gxb.directives.uis._videoController=function(i,a){var n=null,r=null,s=null,o=!1,l=function(i){var a=i.userSchedule||{},n=i.learnRecord||{};return{wrapId:i.videoElementId,videoId:i.video.contentId,chapterId:i.chapterId,classId:i.classId,learnRecord:n,learnComplete:2==a.learnStatus,time:i.time,maxViewTime:n.maxViewTime||0,sessionId:e.encryptUtils.md5(new String((new Date).getTime())),wangsuPaths:t.cdn.wangsu.getPaths(),wangsuDomains:t.cdn.wangsu.getDomains(),isNormal:i.isNormal,isPreview:i.isPreview,height:i.height,width:i.width,headfootConfig:null,hostList:i.localHost&&i.localHost.hostUrl?i.localHost.hostUrl.split("|"):[],videoConfig:{src:i.video.file,poster:i.video.cover,srt:i.video.srt},src:null,poster:null,srt:null,title:null,isLocalHost:!1}}(i),c=function(e,t,i){$.ajax({type:"HEAD",url:e,crossDomainHeader:!1}).fail(function(){i&&i(e)}).done(function(){t&&t(e)})},u=function(e,t,i,a){if(e=e||[],a=a||"",0===e.length)return void(i&&i());for(var n,r=0;n=e[r++];)c(n+a,t,i)},d=function(e,t,i,a){if(e=e||[],0===e.length)return void(i&&i());var n=null,r=0,s=e.length;u(e,function(e){n||(n=e,t&&t(n))},function(){r++,r>=s&&i&&i()},a)},g=function(t){var i=function(){return"function"==typeof videojs&&videojs.getComponent("QualityPicker")};i()?t():e.loaderUtils.jsLoader([e.pathUtils.concatLocalJSPath("/video-js/video.js"),e.pathUtils.concatLocalJSPath("/video-js/videojs-flash.js"),e.pathUtils.concatLocalJSPath("/video-js/videojs-contrib-hls.min.js"),e.pathUtils.concatLocalJSPath("/video-js/lang/zh-CN.js"),e.pathUtils.concatLocalJSPath("/video-js/vjs-quality-picker.min.js")],function(){var e=a.$interval(function(){i()&&(a.$interval.cancel(e),t())},10)})},p=function(e){!l.isNormal&&l.videoId?a.$classesSrv.getFilmHeadFoot(l.videoId).then(function(t){l.headfootConfig=t,e&&e()}):(l.headfootConfig={header:!1,footer:!1,logo:!1},e&&e())},m=function(){var e,t,i,a,n=function(e){e=e||"";var t=e.match(/[^\/]+?$/);return t?t[0]:""},r=function(){l.src=a,l.poster=l.videoConfig.poster,l.srt=l.videoConfig.srt,l.title="wangsu",l.isLocalHost=!1},s=function(a){l.src=a+"/"+l.wangsuPaths.video_file_bucket+"/"+e,l.poster=a+"/"+l.wangsuPaths.video_srt_bucket+"/"+t,l.srt=a+"/"+l.wangsuPaths.video_cover_bucket+"/"+i,l.title="校内",l.isLocalHost=!0},o=function(){e=n(l.videoConfig.src).replace(/(\.\w+)?$/,".m3u8"),t=n(l.videoConfig.poster),i=n(l.videoConfig.srt),a=l.videoConfig.src.replace(/(\.\w+)?$/,".m3u8")};return function(e){o(),d(l.hostList,function(t){s(t),e()},function(){r(),e()})}}(),f=function(){var e=[],t=0,i=0,a=function(){l.isPreview?e.push({label:"高清",suffix:"",value:0}):(e.push({label:"标清",suffix:"_trans480p",value:0}),e.push({label:"高清",suffix:"_trans720p",value:1}),e.push({label:"流畅",suffix:"_trans360p",value:2}))};return a(),{setCurrentQuality:function(i){return t=e[i]?i:0},getCurrentQuality:function(){return t},getCurrentQualitySrc:function(i){var a=e[t].suffix;return i.replace(/(\.\w+)$/,a+"$1")},existQuality:function(t){return!!e[t]},getQualityItems:function(){return e},getInitialQuality:function(){return i}}}(),h=function(e){c(v().src,e,function(){var t=f.getCurrentQuality()+1;f.existQuality(t)?(f.setCurrentQuality(t),h(e)):l.src.match(/\.m3u8$/)?(l.src=l.src.replace(/\.m3u8$/,".mp4"),f.setCurrentQuality(f.getInitialQuality()),h(e)):(f.setCurrentQuality(f.getInitialQuality()),l.src="",e(""))})},v=function(){return{src:f.getCurrentQualitySrc(l.src),type:l.src.match(/\.m3u8$/)?"application/x-mpegURL":"video/mp4"}},x=function(e){var t=function(){l.headfootConfig&&l.src&&h(e)};p(t),m(t)},b=a.$pluginComponents.$videoLog.init({chapterId:l.chapterId,classId:l.classId}),y=function(e,t,i){i=i||{},this.state=e,this.level=n.quality(),this.ch=i.ch||n.currentTime(),this.ph=i.ph||0,this.ct=(new Date).getTime(),this.desc=t,this.sessionID=l.sessionId},_=function(e,t,i){t=t||{},i=i||function(){};var a={flash:{swf:"/js/video-js/video-js.swf"},techOrder:["html5","flash"],preload:"metadata",controls:!1,loop:!1,fluid:!1,language:"zh-CN"},n=$('<video class="video-js video-js-skin" crossorigin="anonymous">'+(t.srt?'<track kind="subtitles" src="'+t.srt+'" srclang="zh-CN" label="中文" default>':"")+"</video>");n.appendTo(e);var r=videojs(n.get(0),$.extend({},a,t),function(){$(r.el()).children("video,object").css("object-fit","fill"),i()});r.enable=function(){r.removeClass("vjs-disabled")},r.disable=function(){r.addClass("vjs-disabled")},$(r.el()).children("video,object").css("object-fit","fill");var s=function(){if(r&&r.el()){var t=e.width();e.height();t||r.fluid(!0);var i=l.width||t,a=l.height||9*t/16;r.dimensions(i,a)}};return s(),r},D=function(e){var t=_(e);return t.src("//gxbvideo-gs.gaoxiaobang.com/splice/%E9%AB%98%E6%A0%A1%E9%82%A6-%E7%89%87%E5%A4%B4.mp4"),t.load(),t.disable(),t},U=function(e){var t=_(e);return t.src("//gxbvideo-gs.gaoxiaobang.com/splice/%E9%AB%98%E6%A0%A1%E9%82%A6-%E7%89%87%E5%B0%BE.mp4"),t.load(),t.disable(),t},P=function(e,t,i){var a=_(e,{poster:t,srt:i,controls:!0});return a},I=function(){n&&(n.dispose(),n=null),r&&(r.dispose(),r=null),s&&(s.dispose(),s=null);var t=$("#"+l.wrapId),i=0;n=P(t,l.poster,l.srt),n.addClass("vjs-visibility-hidden");var o=new Image;o.onload=function(){n.removeClass("vjs-visibility-hidden")},o.onerror=function(){n.removeClass("vjs-visibility-hidden")},o.src=l.poster,l.headfootConfig.header&&(r=D(t),r.on("error",function(){r.disable(),n.enable(),n.play(),r.dispose(),r=null})),l.headfootConfig.footer&&(s=U(t));var c=$('<img class="video-js-logo" src="//gxbvideo-gs.gaoxiaobang.com/splice/logo/filmLogo.png" />').hide().appendTo(n.el()),u=function(){var e=n.controlBar.getChild("volumePanel");n.controlBar.removeChild(e);var t=n.controlBar.getChild("fullscreenToggle");n.controlBar.removeChild(t);var a=n.controlBar.getChild("currentTimeDisplay");a.show();var r=n.controlBar.getChild("durationDisplay");n.controlBar.removeChild(r),n.controlBar.removeChild(n.controlBar.getChild("remainingTimeDisplay")),n.controlBar.removeChild(n.controlBar.getChild("subsCapsButton")),n.controlBar.addChild(r),r.show(),n.controlBar.addChild("QualityPicker",{qualityItems:f.getQualityItems()});var s=f.getCurrentQuality();n.quality(s),n.on("qualitychange",function(){var e=n.quality();f.setCurrentQuality(e),i=n.currentTime();var t=n.paused();n.src(v()),t||n.play(),b.addLog(new y("levelsChanged","切换清晰度到："+e))}),n.controlBar.addChild(e),n.controlBar.addChild(t);var o=$(n.controlBar.el()),c=o.children(".vjs-quality-picker");if(l.srt){var u=!0,d=n.getChild("textTrackDisplay"),g=$('<button class="vjs-control vjs-button vjs-textrack-btn active" type="button"><span class="vjs-button-text">字幕</span></button>');g.click(function(){var e=$(this);e.toggleClass("active"),e.hasClass("active")?(d.show(),u=!0):(d.hide(),u=!1)}),c.before(g),n.on("loadeddata",function(){u?d.show():d.hide()})}};u();var d=function(){$(".chapter-next").trigger("click")},g=function(){r&&(c.hide(),r.one("ended",function(){r.disable(),n.enable(),n.play()}),n.readyState()>1?n.pause():n.on("loadeddata",function(){n.pause()}),n.disable(),r.enable(),r.play())},p=function(){return s?(c.hide(),s.one("ended",function(){s.disable(),n.enable(),d()}),n.disable(),s.enable(),void s.play()):void d()},m=function(){n.src(v()),n.enable(),r&&r.disable(),s&&s.disable(),n.one("play",function(){g()}),n.one("ended",function(){p()})};n.one("loadeddata",function(){n.removeClass("vjs-visibility-hidden")}),n.one("play",function(){$(".video-progress-new-cxh").show(),$(".loading_video_cxh").show()}),n.on("loadeddata",function(){i&&(n.addClass("vjs-has-started"),n.currentTime(i),i=0),l.time&&n.currentTime(l.time)}),n.on("play",function(){l.headfootConfig.logo&&c.show(),b.addLog(new y("play","视频播放开始"))}),n.on("pause",function(){b.addLog(new y("pause","暂停"))}),n.on("ended",function(){b.addLog(new y("complete","视频播放完成")),m()}),n.on("timeupdate",function(){t.parents("body").length<1&&(n&&(n.dispose(),n=null),r&&(r.dispose(),r=null),s&&(s.dispose(),s=null))});var x=-1;n.on("seeking",function(){var e=parseInt(n.currentTime());x==-1&&(x=e)}),n.on("seeked",function(){x!=-1&&(b.addLog(new y("seek","拖动清度条到："+n.currentTime(),{ch:x,ph:n.currentTime()})),x=-1)}),n.on("volumechange",function(){n.muted()?b.addLog(new y("mute","设置为静音")):b.addLog(new y("volume","调整音量到："+volume))}),n.on("fullsreenchange",function(){b.addLog(new y("fullscreen",n.isFullscreen()?"切换到全屏":"切换到非全屏"))}),n.on("error",function(){if(l.src){var e=n.quality();f.existQuality(e+1)?(f.setCurrentQuality(e+1),h(function(){n.quality(f.getCurrentQuality()),n.play()})):f.setCurrentQuality(f.getInitialQuality())}});var _=null;n.on("waiting",function(){_={startTime:(new Date).getTime(),slowReason:2}}),n.on("playing",function(){if(_){var t=(new Date).getTime()-_.startTime;t>5e3&&b.addLog(e.objectUtils.extend(new y("stalled",1===_.slowReason?"发生卡顿":"发生慢加载"),{slow_load_position:playerInstance.getPosition(),slow_load_duration:t/1e3,code_rate:"0",is_close_browser:2,video_url:n.currentSrc(),slow_down_type:_.slowReason})),_=null}}),m(),n.load(),l.isNormal&&!l.time||n.play(),a.$interval(function(){if(n){var e=parseInt(n.currentTime());e>l.maxViewTime&&(l.maxViewTime=e)}},1e3)},w=function(){l.videoConfig&&(o||(o=!0,x(function(){I(),o=!1})))};g(w)}}(gxb.utils,gxb.settings),function(e,t){e.uis.assetDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/asset/asset"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=2,e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.photoTitle=gxb.settings.identifier.getPhotoTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1,e.changeSlide=function(e){}}]}},e.inheritFromDir(e.uis.assetDir),e.registerDependency("gxb.directives.uis.assetDir",[]),e.registerDirective("gxbasset","gxb.directives.uis.assetDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.card.dateCardDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/card/date.card"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=3,e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList||[],e.$apply()},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.card.dateCardDir),e.registerDependency("gxb.directives.uis.card.dateCardDir",[]),e.registerDirective("gxbdatecard","gxb.directives.uis.card.dateCardDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.card.infoCardDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/card/info.card"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.opens=function(e){window.open(e)}}]}},e.inheritFromDir(e.uis.card.infoCardDir),e.registerDependency("gxb.directives.uis.card.infoCardDir",[]),e.registerDirective("gxbinfocard","gxb.directives.uis.card.infoCardDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_arrangeDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_arrange/index"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.course_detail_arrangeDir),e.registerDependency("gxb.directives.uis.course_detail_arrangeDir",[]),e.registerDirective("gxbclassinfo","gxb.directives.uis.course_detail_arrangeDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_chapterDir=function(e){var i=function(e){e=e||{},this.classId=e.classId||null,this.chapterId=e.chapterId||null,this.video={uuid:e.uuid||null,title:e.uuid||null,file:e.filePath||null,srt:e.srtPath||null,cover:e.coverPath||null,contentId:e.contentId||null},this.time=e.time||0,this.localHost=e.localHost||{},this.isNormal=e.isNormal||!1,this.isPreview=e.isPreview||!1},a=this;
return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_chapter/index"),replace:!0,link:function(e,i,n){e.apiUrl=a.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.isManager=gxb.settings.identifier.hasAministrationRole(),e.data=t.data,e.$apply()},function(){})},controller:["$scope","$element",function(n,r){n.playInfo={playing:!1,title:""},gxb.settings.identifier.ischinayouthstartup()?(n.chapterName="章节学习",n.chapterView="开始学习"):(n.chapterName="章节试学",n.chapterView="预览"),n.closeVideo=function(){n.playInfo.playing=!1,$("#videoPlayer").empty(),$(".img-mask").css({display:"none"})},n.onPreview=function(r){if(console.log(r),r&&"Programming"==r.contentType){var s=r.contentId;n.programApiUrl=a.resolveUrl(t.stringUtils.format("/programming/codeReplay/"+s+"/api",n.parameter)),console.log(n.programApiUrl);var o=window.open("","_blank");t.ajaxUtils.doGet({url:n.programApiUrl}).then(function(e){var t=e.languageid||"",i="000000";if(gxb.settings.identifier.getUserID())i=gxb.settings.identifier.getUserID();else{for(var a="",n=0;n<6;n++)a+=Math.floor(10*Math.random());i=a}!e||"1"!=e.programmingSource||"10"!=e.languageid&&"4"!=e.languageid&&"11"!=e.languageid?o.location.href="https://programming.gaoxiaobang.com/player.html?codeReplayId="+s+"&languageid="+t+"&role=0&userId="+i:o.location.href="https://programming.gaoxiaobang.com/v1.1/player.html?codeReplayId="+s+"&languageid="+t+"&role=0&userId="+i},function(){})}else{$("#videoPlayer").empty();var l="<gxbvideo data='data'></gxbvideo>",c=n.$new();c.data=new i(r),$("#videoPlayer").append(e.$compile(l)(c)[0]),$(".img-mask").css({display:"block"}),window.setTimeout(function(){n.playInfo.playing=!0,n.playInfo.title=r.title},30)}},n.max=10,n.ratingVal=2,n.readonly=!1,n.onHover=function(e){n.hoverVal=e},n.onLeave=function(){n.hoverVal=null},n.onChange=function(e){n.ratingVal=e},n.showVideoFn=function(){var e=setInterval(function(){$(".chapterMain ul li").each(function(){var t=$(this);t.find("span").size()&&(t.find(".icon-film").removeClass("NOclick"),t.find(".icon-film").addClass("filmDiv"),clearInterval(e))})},10)},n.showVideoFn()}]}},e.inheritFromDir(e.uis.course_detail_chapterDir),e.registerDependency("gxb.directives.uis.course_detail_chapterDir",[]),e.registerDirective("gxbcoursechapter","gxb.directives.uis.course_detail_chapterDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_coursejsDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_coursejs/index"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data,e.$apply()},function(){}),e.length=3,e.text="展开讲师",e.openAll=function(t){e.length==t?(e.length=3,e.text="展开讲师"):3==e.length&&(e.length=t,e.text="收起讲师")}},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.course_detail_coursejsDir),e.registerDependency("gxb.directives.uis.course_detail_coursejsDir",[]),e.registerDirective("gxbcoursejs","gxb.directives.uis.course_detail_coursejsDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_courselistDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_courselist/index"),replace:!0,link:function(a,n,r){a.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,a.parameter)),a.mapper=r.mapper,a.key=r.key,t.ajaxUtils.doGet({url:a.apiUrl}).then(function(n){a.data=n.data;var r=e.$state.params.classId;t.ajaxUtils.doGet({url:i.resolveUrl("/evaluations/"+r+"/api?curPage=1&pageSize=5")}).then(function(e){a.total=e.paging.total},function(){}),t.ajaxUtils.doGet({url:i.resolveUrl("class/"+r+"/api")}).then(function(e){a.detaildata=e.data},function(){}),a.$apply()},function(){})},controller:["$scope","$element",function(e,a){var n=0,r=function(){return $(".listcourseAbout[data-key] >.list")},s=null,o=function(){return null===s&&(s=r().offset().top),s};gxb.settings.identifier.ischinayouthstartup()?(e.chapterName="章节学习",e.startLearnBtn=!1):(e.chapterName="章节试学",e.startLearnBtn=!0);var l=null,c=function(){return $(".courseAbout")},u=function(){return null===l&&(l=c().offset().top-n),l},d=null,g=function(){return $(".chapter")},p=function(){return null===d&&(d=g().offset().top-120),d},m=null,f=function(){return $(".arrange")},h=function(){return null===m&&(m=f().offset().top-n),m},v=null,x=function(){return $(".evaluate")},b=function(){return null===v&&(v=x().offset().top-n),v};$(document,document.body).scroll(function(){var e=document.body.scrollTop||document.documentElement.scrollTop;e>=o()?(r().addClass("checked"),r().parent().css("padding-top","70px")):(r().removeClass("checked"),r().parent().css("padding-top","0"),r().find(".div-start").addClass("hide"));var t=r();!function(){t.find("a").each(function(){$(this).removeClass("current")})}(),e<p()?t.find(".tab_intro").addClass("current"):e<h()?t.find(".tab_chapter").addClass("current"):e<b()?t.find(".tab_teach").addClass("current"):t.find(".tab_comment").addClass("current")}),t.ajaxUtils.doGet({url:i.resolveUrl("/class/study/api"),data:{classId:e.parameter.classId}}).then(function(t){e.result=t}),e.study=function(){t.ajaxUtils.doPost({url:i.resolveUrl("/class/startStudy/api"),data:{classId:e.parameter.classId}}).then(function(t){t>0?window.location.href=gxb.settings.identifier.goLMS()+"/class/"+e.parameter.classId+"/announcement":gxb.settings.identifier.goLoginUrl()})},e.classIdData={classId:e.parameter.classId,isShow:!1},e.unauthorizedUser=function(){e.classIdData.isShow=!0},e.gostudy=function(){window.location.href=gxb.settings.identifier.goLMS()+"/class/"+e.parameter.classId+"/announcement"},e.gotoAnchor=function(e,t,i){switch(e){case"tab_intro":$(document.body).scrollTop(u()-70),document.documentElement.scrollTop=u()-70,document.body.scrollTop=u()-70;break;case"tab_chapter":$(document.body).scrollTop(p()+50),document.documentElement.scrollTop=p()+50,document.body.scrollTop=p()+50;break;case"tab_teach":$(document.body).scrollTop(h()),document.documentElement.scrollTop=h(),document.body.scrollTop=h();break;case"tab_comment":$(document.body).scrollTop(b()+120),document.documentElement.scrollTop=b()+120,document.body.scrollTop=b()+120}},e.minniClass_view=function(e){e.stopPropagation();var t=$(".chapterMain ul li span").eq(0);setTimeout(function(){angular.element(t).triggerHandler("click")},0)}}]}},e.inheritFromDir(e.uis.course_detail_courselistDir),e.registerDependency("gxb.directives.uis.course_detail_courselistDir",[]),e.registerDirective("gxbcourselist","gxb.directives.uis.course_detail_courselistDir",["$compile","$interval","$anchorScroll","$location","$state"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_coursexgDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_coursexg/index"),replace:!0,link:function(e,a,n){e.parameter.curPage="",e.parameter.pageSize="",e.parameter.type="related",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(a){t.ajaxUtils.doGet({url:i.resolveUrl("/tenant/current")}).then(function(t){e.relatedType=t.data.relatedType,e.$apply()}),e.data=a.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.course_detail_coursexgDir),e.registerDependency("gxb.directives.uis.course_detail_coursexgDir",[]),e.registerDirective("gxbcoursexg","gxb.directives.uis.course_detail_coursexgDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_evaluateDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_evaluate/index"),replace:!0,link:function(a,n,r){a.ngPaginationConfig={pageCount:1,onPageChangeScrollToTop:!1,visiblePageCount:5,prevText:"Prev",nextText:"Next",showIfOnePage:!1,currentPage:1,pagenums:[]};var s="<gxbtmpagination conf='ngPaginationConfig' page-count='ngPaginationConfig.pageCount' current-page='currentPage' on-page-change='onPageChange()'></gxbtmpagination>",o=a.$new();o.onPageChange=function(){a.pageer(this.currentPage)},$("#pagination").append(e.$compile(s)(o)[0]),a.pageer=function(e){a.parameter.curPage=e,a.parameter.pageSize=5;var n=a.parameter.courseId;a.parameter.courseId=a.parameter.classId,a.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,a.parameter)),a.parameter.courseId=n,t.ajaxUtils.doGet({url:a.apiUrl,cacheable:!1}).then(function(e){if(a.data=e.dataList,a.total=e.paging.total,a.ngPaginationConfig.pageCount=e.paging.totalPage,a.ngPaginationConfig.visiblePageCount=e.paging.totalPage>5?5:e.paging.totalPage,0==a.ngPaginationConfig.pagenums.length)for(var t=0;t<a.ngPaginationConfig.visiblePageCount;t++)a.ngPaginationConfig.pagenums.push(t+1);a.$apply()})},t.ajaxUtils.doGet({url:i.resolveUrl("/class/"+a.parameter.classId+"/api")}).then(function(e){a.parameter.courseId=e.data.courseId,a.avgScore=e.data.avgScore,t.ajaxUtils.doGet({url:i.resolveUrl("/evaluation/user/"+a.parameter.classId+"/api")}).then(function(e){e.status?null==e.data||""==e.data?a.subname="提交评论":(a.subname="修改",a.content=e.data.content):a.subname="提交评论"}),a.pageer(1),a.$apply()})},controller:["$scope","$element",function(e,a,n){e.ratingValue=5,e.add=function(){var a=e.content,n=e.ratingValue;if(null==a||""==a)return alert("请输入评价"),!1;var r={courseId:e.parameter.courseId,content:a,rating:n,classId:e.parameter.classId};t.ajaxUtils.doPost({url:i.resolveUrl("/evaluation/class/api"),data:r}).then(function(a){a.status?(t.ajaxUtils.doGet({url:i.resolveUrl("/evaluation/user/"+e.parameter.classId+"/api")}).then(function(t){t.status?null==t.data||""==t.data?e.subname="提交评论":(e.subname="修改",e.content=t.data.content):e.subname="提交评论"},function(){}),e.ngPaginationConfig.pagenums=[],e.pageer(1)):gxb.settings.identifier.goLoginUrl(),e.$apply()},function(e){alert(e.msg)})},e.userrating=function(a,n,r){t.ajaxUtils.doGet({url:i.resolveUrl("/evaluations/users/api"),data:{evaluationId:r}}).then(function(n){var s={courseId:e.parameter.courseId,userrating:a,evaluationId:r,classId:e.parameter.classId};n.status?t.ajaxUtils.doPost({url:i.resolveUrl("/evaluation/userrating/api"),data:s}).then(function(t){t.status&&(e.ngPaginationConfig.pagenums=[],e.pageer(1))}):n.status||"未登录"!=n.message?alert("已点过赞"):gxb.settings.identifier.goLoginUrl()})}}]}},e.inheritFromDir(e.uis.course_detail_evaluateDir),e.registerDependency("gxb.directives.uis.course_detail_evaluateDir",[]),e.registerDirective("gxbevaluate","gxb.directives.uis.course_detail_evaluateDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_detail_studyVedioDir=function(e){var i=function(e){e=e||{},this.classId=e.classId||null,this.chapterId=e.chapterId||null,this.video={uuid:e.uuid||null,title:e.title||null,file:gxb.settings.cdn.getPreviewPath(e.filePath||""),srt:gxb.settings.cdn.getPreviewPath(e.srtPath||""),cover:gxb.settings.cdn.getPreviewPath(e.coverPath||"")},this.time=e.time||0,this.localHost=e.localHost||{},this.isNormal=e.isNormal||!1,this.isPreview=e.isPreview||!1,this.height="250px",this.width="400px"},a=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_detail_studyVedio/course_detail_studyVedio"),replace:!0,link:function(n,r,s){n.apiUrl=a.resolveUrl(t.stringUtils.format(s.api,n.parameter)),n.mapper=s.mapper,n.key=s.key,t.ajaxUtils.doGet({url:n.apiUrl}).then(function(r){if(n.data=r.data,n.deleteFlag=parseInt(r.data.deleteFlag),n.collectionsCount=r.data.collectionsCount,n.data.promotionalVideo){$("#videoPromotionPlayer").empty();var s="<gxbvideo data='data'></gxbvideo>",o=n.$new();o.data=new i({classId:n.parameter.classId,filePath:n.data.promotionalVideo,srtPath:n.data.promotionalVideoSrt,coverPath:n.data.courseCover||n.data.promotionalVideoCover,isPreview:!0,isNormal:!0}),$("#videoPromotionPlayer").append(e.$compile(s)(o)[0])}t.ajaxUtils.doGet({url:a.resolveUrl("/user/class/"+n.parameter.classId+"/collection/api")}).then(function(e){n.restrstatus=e.status,n.$apply()});var l=e.$state.params.classId;t.ajaxUtils.doGet({url:a.resolveUrl("class/"+l+"/api")}).then(function(e){n.detaildata=e.data},function(){}),n.$apply(),t.ajaxUtils.doGet({url:a.resolveUrl("/class/study/api"),data:{classId:n.parameter.classId}}).then(function(e){n.result=e,n.$apply()})})},controller:["$scope","$element",function(i,n){var r={classId:i.parameter.classId};i.study=function(){t.ajaxUtils.doPost({url:a.resolveUrl("/class/startStudy/api"),data:r}).then(function(e){e>0?window.location.href=gxb.settings.identifier.goLMS()+"/class/"+i.parameter.classId+"/announcement":gxb.settings.identifier.goLoginUrl()})},gxb.settings.identifier.ischinayouthstartup()?i.isRemove=!0:i.isRemove=!1,i.gostudy=function(){window.location.href=gxb.settings.identifier.goLMS()+"/class/"+i.parameter.classId+"/announcement"},i.classIdData={classId:i.parameter.classId,isShow:!1},i.unauthorizedUser=function(){i.classIdData.isShow=!0},i.showZygj=gxb.settings.identifier.isZYGJTenant(),i.collput=function(){t.ajaxUtils.doPost({url:a.resolveUrl("/user/class/"+i.parameter.classId+"/collection/api")}).then(function(e){e.status&&(i.collectionsCount++,i.restrstatus=!0),i.$apply()})},i.colldelete=function(){t.ajaxUtils.doDelete({url:a.resolveUrl("/user/class/"+i.parameter.classId+"/collection/api")}).then(function(e){e.status&&(i.restrstatus=!1,i.collectionsCount--),i.$apply()})},i.watch_times=0,e.$classesSrv.get_watch_times(i.parameter.classId).then(function(e){i.watch_times=e.data}),i.minniClass_view=function(t){t.stopPropagation(),e.$classesSrv.watch_times(i.parameter.classId),gxb.utils.userLogUtils.operation.miniclass.sendMiniClassClickEvent({classId:i.parameter.classId});var a=$(".chapterMain ul li span").eq(0);setTimeout(function(){angular.element(a).triggerHandler("click")},5)}}]}},e.inheritFromDir(e.uis.course_detail_studyVedioDir),e.registerDependency("gxb.directives.uis.course_detail_studyVedioDir",[]),e.registerDirective("gxbstudyvedio","gxb.directives.uis.course_detail_studyVedioDir",["$compile","$interval","$state","gxb.services.classes.classesSrv"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_square_categoryDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_square_category/index"),replace:!0,link:function(a,n,r){a.curPage=1,a.pageSize=8,a.newHot="new",a.searchText="",a.tab=0,a.categoryId="",a.cateName="全部课程",a.currentnew="current",a.currenthot="",a.ngPaginationConfig={pageCount:1,visiblePageCount:5,prevText:"Prev",nextText:"Next",showIfOnePage:!1,currentPage:1,pagenums:[]};var s=a.$new();s.onPageChange=function(){a.fetchNews(a.curPage,a.pageSize,a.searchText,a.newHot,a.categoryId)},a.addPaging=function(){a.ngPaginationConfig={pageCount:1,visiblePageCount:5,prevText:"Prev",nextText:"Next",showIfOnePage:!1,currentPage:1,pagenums:[]};var t="<gxbtmpagination conf='ngPaginationConfig' page-count='ngPaginationConfig.pageCount' current-page='currentPage' on-page-change='onPageChange()'></gxbtmpagination>";$("#pagination").empty(),$("#pagination").append(e.$compile(t)(a)[0]),a.$apply()},a.addPaging(),a.fetchNews=function(e,n,r,s,o){var l="class/api?curPage="+e+"&pageSize="+n+"&search="+r+"&newHot="+s+"&categoryId="+o;t.ajaxUtils.doGet({url:i.resolveUrl(l)}).then(function(e){if(a.classlist=e.dataList||[],a.total=e.paging.total,0==r.length&&0==o.length&&(a.totalqb=e.paging.total),a.ngPaginationConfig.pageCount=e.paging.totalPage,a.ngPaginationConfig.visiblePageCount=e.paging.totalPage>5?5:e.paging.totalPage,0==a.ngPaginationConfig.pagenums.length)for(var t=0;t<a.ngPaginationConfig.visiblePageCount;t++)a.ngPaginationConfig.pagenums.push(t+1);a.$apply()})},a.fetchNews(a.curPage,a.pageSize,a.searchText,a.newHot,a.categoryId),a.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,a.parameter)),a.mapper=r.mapper,a.key=r.key,t.ajaxUtils.doGet({url:a.apiUrl}).then(function(e){a.categoryslist=e.data||[],a.$apply()}),t.ajaxUtils.doGet({url:i.resolveUrl("/class/api?curPage=1&pageSize=8&search=&newHot=hot&categoryId=")}).then(function(e){a.hotclasslist=e.dataList||[],a.$apply()})},controller:["$scope","$element",function(e,t){e.allcate=function(t,i,a,n,r,s){r.stopPropagation(),1==a&&window.open(n),0==a&&(e.cateName=s,e.tab=i,e.categoryId=t,e.ngPaginationConfig.pagenums=[],e.addPaging(),e.fetchNews(e.curPage,e.pageSize,e.searchText,e.newHot,e.categoryId))},e.all=function(t){e.cateName=t,e.curPage=1,e.categoryId="",e.ngPaginationConfig.pagenums=[],e.addPaging(),e.fetchNews(e.curPage,e.pageSize,"","new",e.categoryId)},e.search=function(){e.ngPaginationConfig.pagenums=[],e.searchText=e.searchText,e.addPaging(),e.fetchNews(e.curPage,e.pageSize,e.searchText,e.newHot,e.categoryId)},e.myKeyup=function(t){var i=window.event?t.keyCode:t.which;13==i&&e.search()},e.newHots=function(t){e.newHot=t,"new"==t?(e.currentnew="current",e.currenthot=""):(e.currentnew="",e.currenthot="current"),e.ngPaginationConfig.pagenums=[],e.addPaging(),e.fetchNews(e.curPage,e.pageSize,e.searchText,e.newHot,e.categoryId)},e.onPageChange=function(){e.fetchNews(this.currentPage,e.pageSize,e.searchText,e.newHot,e.categoryId)}}]}},e.inheritFromDir(e.uis.course_square_categoryDir),e.registerDependency("gxb.directives.uis.course_square_categoryDir",[]),e.registerDirective("gxbcategorys","gxb.directives.uis.course_square_categoryDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_square_hzDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_square_hz/index"),replace:!0,link:function(e,a,n){e.parameter.curPage="",e.parameter.pageSize="",e.parameter.type="hezuo",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(a){t.ajaxUtils.doGet({url:i.resolveUrl("/tenant/current")}).then(function(t){e.hezuoType=t.data.hezuoType,e.$apply()}),e.coursesList=a.dataList||[],e.$apply()}),console.log(e)},controller:["$scope","$element",function(e,t){gxb.settings.identifier.ischinayouthstartup()?e.startLearnBtn=!1:e.startLearnBtn=!0}]}},e.inheritFromDir(e.uis.course_square_hzDir),e.registerDependency("gxb.directives.uis.course_square_hzDir",[]),e.registerDirective("gxbhezuocourse","gxb.directives.uis.course_square_hzDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.course_square_sildeDir=function(e){var i=this,a=0;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course_square_silde/index"),replace:!0,link:function(e,n,r){e.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,e.parameter)),e.mapper=r.mapper,e.key=r.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.slides=t.dataList||t.data||[],a=e.slides.length},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=0,e.preSlide=function(){e.activeIndex--,e.activeIndex<0&&(e.activeIndex=a-1),$(".courseinit").css({"margin-left":e.activeIndex*-1200})},e.nextSlide=function(){e.activeIndex++,e.activeIndex>=a&&(e.activeIndex=0),$(".courseinit").css({"margin-left":e.activeIndex*-1200})}}]}},e.inheritFromDir(e.uis.course_square_sildeDir),e.registerDependency("gxb.directives.uis.course_square_sildeDir",[]),e.registerDirective("gxbsquaresilde","gxb.directives.uis.course_square_sildeDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.courseDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/course/course"),replace:!0,link:function(e,a,n){e.parameter.curPage="",e.parameter.pageSize="",e.parameter.type="jingcaishiting",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.jingcaiTitle=gxb.settings.identifier.getJingcaiTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1,e.changeSlide=function(e){}}]}},e.inheritFromDir(e.uis.courseDir),e.registerDependency("gxb.directives.uis.courseDir",[]),e.registerDirective("gxbncourse","gxb.directives.uis.courseDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.descDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/desc/desc"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.relatedIntroTitle=gxb.settings.identifier.getRelatedIntroTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.descDir),e.registerDependency("gxb.directives.uis.descDir",[]),e.registerDirective("gxbdesc","gxb.directives.uis.descDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.newsrDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/news/news"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=5,e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.newsTitle=gxb.settings.identifier.getNewsTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1,e.changeSlide=function(e){}}]}},e.inheritFromDir(e.uis.newsrDir),e.registerDependency("gxb.directives.uis.newsrDir",[]),e.registerDirective("gxbnews","gxb.directives.uis.newsrDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.tabsDir=function(e){return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/page_tabs/tabs"),replace:!0,link:function(e,t,i){e.defaultTab=i["default"]},controller:["$scope","$element",function(t,i){e.$studentListSrv.gettenant().then(function(e){t.tenant=e.data,t.$apply()})}]}},e.inheritFromDir(e.uis.tabsDir),e.registerDependency("gxb.directives.uis.tabsDir",[]),e.registerDirective("gxbpagetabs","gxb.directives.uis.tabsDir",["$compile","$interval","gxb.services.tenants.studentListSrv"])}(gxb.directives,gxb.utils),function(e,t){e.uis.page.tmpaginationDir=function(e){return{link:function(e,t,i){function a(){var t,i,a;if(e.conf.pagenums=[],0!==e.conf.pageCount)for(e.currentPage>e.conf.pageCount&&(e.currentPage=1),e.conf.pageCount<=n?(t=1,i=e.conf.pageCount):(a=Math.ceil(n/2),t=Math.max(e.currentPage-a,1),i=Math.min(t+n-1,e.conf.pageCount),e.conf.pageCount-i<a&&(t=i-n+1));t<=i;t++)e.conf.pagenums.push(t)}var n=angular.isDefined(i.visiblePageCount)?i.visiblePageCount:e.conf.visiblePageCount;e.prevText=angular.isDefined(i.prevText)?i.prevText:e.conf.prevText,e.nextText=angular.isDefined(i.nextText)?i.nextText:e.conf.nextText,e.showIfOnePage=angular.isDefined(i.showIfOnePage)?i.showIfOnePage:e.conf.showIfOnePage,e.currentPage=e.conf.currentPage,e.pageChange=function(t){e.pageNum="",t>=1&&t<=e.conf.pageCount?(e.currentPage=t,1!=e.conf.pageCount&&e.conf.onPageChangeScrollToTop!==!1&&window.scrollTo(0,0)):e.currentPage=1},e.keyupHanlder=function(t){var i=Number(e.conf.pageCount),a=Number(t);a&&((""==a||a<=1)&&(e.currentPage=1),a>1&&a<i&&(e.currentPage=a),a>=i&&(e.currentPage=e.conf.pageCount))},e.keyUp=function(t,i){var a=window.event?t.keyCode:t.which;13==a&&e.keyupHanlder(e.pageNum);var n=t.srcElement.value.replace(/\D/g,"");e.pageNum=parseInt(n)||1,e.pageNum>e.conf.pageCount&&(e.pageNum=e.conf.pageCount)},e.$watch("currentPage",function(t,i){t!==i&&(a(),e.onPageChange())}),e.$watch("scope.conf.pageCount",function(e,t){e&&a()})},replace:!0,restrict:"E",scope:{conf:"=",currentPage:"=",onPageChange:"&"},template:'<div class="ng-pagination"><ul ng-if="conf.pageCount>0 || conf.showIfOnePage"><li ng-click="pageChange(currentPage-1>0?currentPage-1:1)">上一页</li><li ng-repeat="pagenum in conf.pagenums track by pagenum" ng-click="pageChange(pagenum)" ng-class="{active:currentPage==pagenum}">{{pagenum}}</li><li ng-click="pageChange(currentPage+1<=conf.pageCount?currentPage+1:currentPage)">下一页</li></ul><p class="totalPage">共{{ conf.pageCount }}页</p><p class="linkTo">第<input type="text" ng-model="pageNum" ng-paste="keyUp($event,this)" ng-keyup="keyUp($event,this)" maxlength="6">页<a href="javascript:void(0)" ng-click="keyupHanlder(pageNum)">跳转</a></p></div>'}},e.inheritFromDir(e.uis.page.tmpaginationDir),e.registerDependency("gxb.directives.uis.page.tmpaginationDir",[]),e.registerDirective("gxbtmpagination","gxb.directives.uis.page.tmpaginationDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.sliderDir=function(e){var i=function(t,i){var a=$("[data-key='"+i+"'].slider .content a"),n=$("[data-key='"+i+"'].slider .indicator a");$(a[0]).addClass("active"),$(n[0]).addClass("active");var r=a.length;e.$interval(function(){t.activeIndex==r&&(t.activeIndex=0);for(var e=0;e<r;e++)$(a[e]).removeClass("active"),$(n[e]).removeClass("active"),e==t.activeIndex&&($(a[e]).addClass("active"),$(n[e]).addClass("active"));t.activeIndex++},3e3)},a=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/slide/slider"),replace:!0,link:function(e,n,r){e.apiUrl=a.resolveUrl(t.stringUtils.format(r.api,e.parameter)),e.mapper=r.mapper,e.key=r.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data,e.$apply(),i(e,e.key)},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1;var i=function(){var t=$("[data-key='"+e.key+"'].slider .content a"),i=t.length;(e.activeIndex>=i||e.activeIndex<0)&&(e.activeIndex=0);for(var a=$("[data-key='"+e.key+"'].slider .indicator a"),n=0;n<i;n++)$(t[n]).removeClass("active"),$(a[n]).removeClass("active"),n==e.activeIndex&&($(t[n]).addClass("active"),$(a[n]).addClass("active"))};e.changeSlide=function(t){e.activeIndex=t,i()},e.nextSlide=function(){e.activeIndex++,i()},e.preSlide=function(){e.activeIndex--,i()}}]}},e.inheritFromDir(e.uis.sliderDir),e.registerDependency("gxb.directives.uis.sliderDir",[]),e.registerDirective("gxbslider","gxb.directives.uis.sliderDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.gxbInstructors=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/teacher/teacher"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=12,e.pageSize_=3,e.curPage_=1,e.totalPage_=4,e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.teacherTitle=gxb.settings.identifier.getTeacherTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList||[];for(var i in e.data)e.data[i].curPage=parseInt(i/e.pageSize_)+1;e.totalPage_=Math.ceil(e.data.length/e.pageSize_),e.$apply()}),e.changePage=function(t){e.curPage_=t}},controller:["$scope","$element",function(t,i){e.$interval(function(){++t.curPage_>t.totalPage_&&(t.curPage_=1)},5e3)}]}},e.inheritFromDir(e.uis.gxbInstructors),e.registerDependency("gxb.directives.uis.gxbInstructors",[]),e.registerDirective("gxbinstructors","gxb.directives.uis.gxbInstructors",[])}(gxb.directives,gxb.utils),function(e,t){e.uis.user_center_lovecourseDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/user_center_lovecourse/index"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=3,e.parameter.type="guessyoulike",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(a){t.ajaxUtils.doGet({url:i.resolveUrl("/tenant/current")}).then(function(t){e.guessyoulikeType=t.data.guessyoulikeType,e.$apply()}),e.data=a.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){var i=window.location.hash||"",a=function(){i.indexOf("#/user/user_my")>=0&&$(".interesting_course").removeClass("interesting_course_pos").addClass("interesting_course_pos1")};a()}]}},e.inheritFromDir(e.uis.user_center_lovecourseDir),e.registerDependency("gxb.directives.uis.user_center_lovecourseDir",[]),e.registerDirective("gxblovecourse","gxb.directives.uis.user_center_lovecourseDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.user_center_menusDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveDefaultTemplatePath("/user_center_menus/index"),replace:!0,link:function(e,a,n){var r=function(){var t=window.location.hash||"";(t.indexOf("#/user/user_home")>=0||t.indexOf("#/user/class_analysis")>=0)&&t.indexOf("#/user")>=0?(e.tab=1,e.add_class_home()):t.indexOf("#/user/user_notify")>=0&&t.indexOf("#/user")>=0?(e.tab=2,e.add_class()):t.indexOf("#/user/user_auth")>=0&&t.indexOf("#/user")>=0?(e.tab=3,e.add_class()):t.indexOf("#/user/my_user_exam")>=0&&t.indexOf("#/user")>=0?(e.tab=4,e.add_class()):t.indexOf("#/user/user_coll")>=0&&t.indexOf("#/user")>=0?(e.tab=5,e.add_class()):t.indexOf("#/user/user_my")>=0&&t.indexOf("#/user")>=0?(e.tab=6,e.del_class()):t.indexOf("#/user/my_course")>=0&&t.indexOf("#/user")>=0?(e.tab=7,e.add_class()):t.indexOf("#/user/training_plan")>=0&&t.indexOf("#/user")>=0?(e.tab=8,e.add_class()):t.indexOf("#/user/user_home")>=0&&t.indexOf("#/user")>=0&&(e.tab=9,e.add_class())};$(".setting ul li").click(function(){$(this).addClass("current").siblings().removeClass("current")}),e.del_class=function(){var e=setInterval(function(){$(".interesting_course").size()&&($(".interesting_course").removeClass("interesting_course_pos").addClass("interesting_course_pos1"),$(".interesting_course, .setting").css({height:"599px"}),$(".content_body_bottom_height").css("height","870px"),$(".setting_main").css("height","600px"),clearInterval(e),r())},10)},e.add_class=function(){var e=setInterval(function(){$(".interesting_course").size()&&($(".interesting_course").addClass("interesting_course_pos").removeClass("interesting_course_pos1"),$(".interesting_course").css({height:"597px"}),$(".setting").css({height:"1099px"}),$(".content_body_bottom_height").css("height","auto"),$(".setting_main").css("height","1100px"),clearInterval(e),r())},10)},e.add_class_home=function(){var e=setInterval(function(){$(".interesting_course").size()&&($(".interesting_course").addClass("interesting_course_pos").removeClass("interesting_course_pos1"),$(".interesting_course").css({height:"602px"}),$(".setting").css({height:"1200px"}),$(".content_body_bottom_height").css("height","auto"),$(".setting_main").css("height","1200px"),clearInterval(e),r())},10)},r(),e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl,cacheable:!1}).then(function(t){e.datastr=t.data,e.$apply()},function(){}),t.ajaxUtils.doGet({url:i.resolveUrl("/class/user_center/api")}).then(function(a){e.data=a.data,e.examListNum=0,t.ajaxUtils.doGet({url:i.resolveUrl("/user/api")}).then(function(a){a.data.studentList&&a.data.studentList.length?e.creditClassNum=e.data.creditClassNum:e.creditClassNum=0,t.ajaxUtils.doGet({url:i.resolveUrl("/exam/list/user")}).then(function(t){t.paging.total>0&&(e.examListNum=t.paging.total),e.$apply()})})}),e.showExam=780==gxb.settings.identifier.getTenantID(),e.showZygj=gxb.settings.identifier.isZYGJTenant(),e.classIdData={isShow:!1},e.authBomb=function(t){t||(e.classIdData.isShow=!0)},gxb.utils.localStorageUtils.get("messageNum")?(e.meLenth=!0,0==gxb.utils.localStorageUtils.get("messageNum")?e.meLenth=!1:gxb.utils.localStorageUtils.get("messageNum")>99?(e.messageNum="99",$("body").find("#messageTips,.messageNumBer").text("99+")):e.messageNum=gxb.utils.localStorageUtils.get("messageNum")):e.meLenth=!1},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.user_center_menusDir),e.registerDependency("gxb.directives.uis.user_center_menusDir",[]),e.registerDirective("gxbmenus","gxb.directives.uis.user_center_menusDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.home_assetDir=function(e){
var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/home_asset/index"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=2,e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.photoTitle=gxb.settings.identifier.getPhotoTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1,e.changeSlide=function(e){}}]}},e.inheritFromDir(e.uis.home_assetDir),e.registerDependency("gxb.directives.uis.home_assetDir",[]),e.registerDirective("gxbhomeasset","gxb.directives.uis.home_assetDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.home_courseDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/home_course/index"),replace:!0,link:function(e,a,n){e.parameter.curPage="",e.parameter.pageSize="",e.parameter.type="jingcaishiting",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.index_start=0,e.index_end=4,e.tab_a=1,e.aBtn_1=!1,e.aBtn_2=!1,e.aBtn_3=!1,e.no_course=!1,e.no_course_class="",e.jingcaiTitle=gxb.settings.identifier.getJingcaiTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,console.log(e.data.length),1==e.data.length?(e.no_course_class="no_course_height_1",e.no_course=!0,console.log(e.data.length)):3==e.data.length?(e.no_course_class="",e.no_course=!0):(e.no_course=!1,e.no_course_class=""),e.data.length>4&&(e.aBtn_1=!0,e.aBtn_2=!0),e.data.length>8&&(e.aBtn_1=!0,e.aBtn_2=!0,e.aBtn_3=!0),e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.changeSlide=function(t,i,a){e.index_start=t,e.index_end=i,e.tab_a=a}}]}},e.inheritFromDir(e.uis.home_courseDir),e.registerDependency("gxb.directives.uis.home_courseDir",[]),e.registerDirective("gxbhomecourse","gxb.directives.uis.home_courseDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.home_descDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/home_desc/index"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.relatedIntroTitle=gxb.settings.identifier.getRelatedIntroTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.home_descDir),e.registerDependency("gxb.directives.uis.home_descDir",[]),e.registerDirective("gxbhomedesc","gxb.directives.uis.home_descDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.home_newsrDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/home_news/index"),replace:!0,link:function(e,a,n){e.parameter.curPage=1,e.parameter.pageSize=5,e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.newsTitle=gxb.settings.identifier.getNewsTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1,e.changeSlide=function(e){}}]}},e.inheritFromDir(e.uis.home_newsrDir),e.registerDependency("gxb.directives.uis.home_newsrDir",[]),e.registerDirective("gxbhomenews","gxb.directives.uis.home_newsrDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.home_sliderDir=function(e){var i=0,a=function(t,i){var a=$("[data-key='"+i+"'] .New_sliderWrapper .content a"),n=$("[data-key='"+i+"'] .New_sliderWrapper .indicator a");$(a[0]).addClass("active"),$(n[0]).addClass("active");var r=a.length;e.$interval(function(){t.activeIndex==r&&(t.activeIndex=0);for(var e=0;e<r;e++)$(a[e]).removeClass("active"),$(n[e]).removeClass("active"),e==t.activeIndex&&($(a[e]).addClass("active"),$(n[e]).addClass("active"));t.activeIndex++},3e3)},n=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/home_slide/index"),replace:!0,link:function(r,s,o){r.apiUrl=n.resolveUrl(t.stringUtils.format(o.api,r.parameter)),r.mapper=o.mapper,r.key=o.key,t.ajaxUtils.doGet({url:r.apiUrl}).then(function(s){i=s.data.length,r.data=s.data,r.$apply(),a(r,r.key),t.ajaxUtils.doGet({url:n.resolveUrl("/school/announcements/api?curPage=1&pageSize=5")}).then(function(t){r.annlist=t.dataList,t.dataList&&(i=t.dataList.length,t.dataList.length>1&&(r.annIndex=0,e.$interval(function(){r.annIndex--,r.annIndex<0&&(r.annIndex=i-1),$(".New_topTextWrapper").css({"margin-top":r.annIndex*-60})},3e3))),r.$apply()})},function(){})},controller:["$scope","$element",function(e,t){e.activeIndex=1;var i=function(){var t=$("[data-key='"+e.key+"'] .New_sliderWrapper .content a"),i=t.length;(e.activeIndex>=i||e.activeIndex<0)&&(e.activeIndex=0);for(var a=$("[data-key='"+e.key+"'] .New_sliderWrapper .indicator a"),n=0;n<i;n++)$(t[n]).removeClass("active"),$(a[n]).removeClass("active"),n==e.activeIndex&&($(t[n]).addClass("active"),$(a[n]).addClass("active"))};e.changeSlide=function(t){e.activeIndex=t,i()},e.nextSlide=function(){e.activeIndex++,i()},e.preSlide=function(){e.activeIndex--,i()}}]}},e.inheritFromDir(e.uis.home_sliderDir),e.registerDependency("gxb.directives.uis.home_sliderDir",[]),e.registerDirective("gxbsecondslider","gxb.directives.uis.home_sliderDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.home_teacher=function(e){var i=function(t,i){var a=$("[data-key='"+i+"'].slider .teacherWrapper_list"),n=$("[data-key='"+i+"'].slider .aSlider");$(a[0]).addClass("active"),$(n[0]).addClass("active");var r=a.length;e.$interval(function(){t.activeIndex==r&&(t.activeIndex=0);for(var e=0;e<r;e++)$(a[e]).removeClass("active"),$(n[e]).removeClass("active"),e==t.activeIndex&&($(a[e]).addClass("active"),$(n[e]).addClass("active"));t.activeIndex++},3e3)},a=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/home_teacher/index"),replace:!0,link:function(e,n,r){e.parameter.curPage=1,e.parameter.pageSize=12,e.apiUrl=a.resolveUrl(t.stringUtils.format(r.api,e.parameter)),e.mapper=r.mapper,e.key=r.key,e.index_start=0,e.index_end=4,e.tab_a=1,e.aBtn_1=!1,e.aBtn_2=!1,e.aBtn_3=!1,e.w386="",e.teacherTitle=gxb.settings.identifier.getTeacherTitle(),t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.dataList,1==e.data.length&&(e.w386="ml406"),2==e.data.length&&(e.w386="ml208"),3==e.data.length&&(e.w386="ml81"),e.data.length>4&&(e.aBtn_1=!0,e.aBtn_2=!0),e.data.length>8&&(e.aBtn_1=!0,e.aBtn_2=!0,e.aBtn_3=!0),e.$apply(),i(e,e.key)})},controller:["$scope","$element",function(e,t){e.changeSlide=function(t,i,a){e.index_start=t,e.index_end=i,e.tab_a=a}}]}},e.inheritFromDir(e.uis.home_teacher),e.registerDependency("gxb.directives.uis.home_teacher",[]),e.registerDirective("gxbhomeinstructors","gxb.directives.uis.home_teacher",[])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_arrangeDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_arrange/index"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.second_arrangeDir),e.registerDependency("gxb.directives.uis.second_arrangeDir",[]),e.registerDirective("gxbsecondclassinfo","gxb.directives.uis.second_arrangeDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_chapterDir=function(e){var i=function(e){e=e||{},this.classId=e.classId||null,this.chapterId=e.chapterId||null,this.video={uuid:e.uuid||null,title:e.uuid||null,file:e.filePath||null,srt:e.srtPath||null,cover:e.coverPath||null,contentId:e.contentId||null},this.time=e.time||0,this.localHost=e.localHost||{},this.isNormal=e.isNormal||!1,this.isPreview=e.isPreview||!1},a=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_chapter/index"),replace:!0,link:function(e,i,n){e.apiUrl=a.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.isManager=gxb.settings.identifier.hasAministrationRole(),e.data=t.data,e.$apply()},function(){})},controller:["$scope","$element",function(n,r){n.playInfo={playing:!1,title:""},gxb.settings.identifier.ischinayouthstartup()?(n.chapterName="章节学习",n.chapterView="开始学习"):(n.chapterName="章节试学",n.chapterView="预览"),n.closeVideo=function(){n.playInfo.playing=!1,$("#videoPlayer").empty(),$(".img-mask").css({display:"none"})},n.onPreview=function(r){if(r&&"Programming"==r.contentType){var s=r.contentId;n.programApiUrl=a.resolveUrl(t.stringUtils.format("/programming/codeReplay/"+s+"/api",n.parameter)),console.log(n.programApiUrl);var o=window.open("","_blank");t.ajaxUtils.doGet({url:n.programApiUrl}).then(function(e){console.log("11111111"),console.log(e),console.log("33333333");var t=e.languageid||"",i="000000";if(console.log(gxb.settings.identifier.getUserID()),gxb.settings.identifier.getUserID())i=gxb.settings.identifier.getUserID();else{for(var a="",n=0;n<6;n++)a+=Math.floor(10*Math.random());i=a}!e||"1"!=e.programmingSource||"10"!=e.languageid&&"4"!=e.languageid&&"11"!=e.languageid?o.location.href="https://programming.gaoxiaobang.com/player.html?codeReplayId="+s+"&languageid="+t+"&role=0&userId="+i:o.location.href="https://programming.gaoxiaobang.com/v1.1/player.html?codeReplayId="+s+"&languageid="+t+"&role=0&userId="+i},function(){})}else{$("#videoPlayer").empty();var l="<gxbvideo data='data'></gxbvideo>",c=n.$new();c.data=new i(r),$("#videoPlayer").append(e.$compile(l)(c)[0]),$(".img-mask").css({display:"block"}),window.setTimeout(function(){n.playInfo.playing=!0,n.playInfo.title=r.title},30)}},n.max=10,n.ratingVal=2,n.readonly=!1,n.onHover=function(e){n.hoverVal=e},n.onLeave=function(){n.hoverVal=null},n.onChange=function(e){n.ratingVal=e},n.showVideoFn=function(){var e=setInterval(function(){$(".chapterMain ul li").each(function(){var t=$(this);t.find("span").size()&&(t.find(".icon-film").removeClass("NOclick"),t.find(".icon-film").addClass("filmDiv"),clearInterval(e))})},10)},n.showVideoFn()}]}},e.inheritFromDir(e.uis.second_chapterDir),e.registerDependency("gxb.directives.uis.second_chapterDir",[]),e.registerDirective("gxbsecondchapter","gxb.directives.uis.second_chapterDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_coursejsDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_coursejs/index"),replace:!0,link:function(e,a,n){e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(t){e.data=t.data,e.$apply()},function(){}),e.length=3,e.text="展开讲师",e.openAll=function(t){e.length==t?(e.length=3,e.text="展开讲师"):3==e.length&&(e.length=t,e.text="收起讲师")}},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.second_coursejsDir),e.registerDependency("gxb.directives.uis.second_coursejsDir",[]),e.registerDirective("gxbsecondcoursejs","gxb.directives.uis.second_coursejsDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_courselistDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_courselist/index"),replace:!0,link:function(a,n,r){a.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,a.parameter)),a.mapper=r.mapper,a.key=r.key,t.ajaxUtils.doGet({url:a.apiUrl}).then(function(n){a.data=n.data;var r=e.$state.params.classId;t.ajaxUtils.doGet({url:i.resolveUrl("/evaluations/"+r+"/api?curPage=1&pageSize=5")}).then(function(e){a.total=e.paging.total},function(){}),t.ajaxUtils.doGet({url:i.resolveUrl("class/"+r+"/api")}).then(function(e){a.detaildata=e.data},function(){}),a.$apply()},function(){})},controller:["$scope","$element",function(e,a){var n=0,r=function(){return $(".listcourseAbout[data-key] >.list")},s=null,o=function(){return null===s&&(s=r().offset().top),s};gxb.settings.identifier.ischinayouthstartup()?(e.chapterName="章节学习",e.startLearnBtn=!1):(e.chapterName="章节试学",e.startLearnBtn=!0);var l=null,c=function(){return $(".courseAbout")},u=function(){return null===l&&(l=c().offset().top-n),l},d=null,g=function(){return $(".chapter")},p=function(){return null===d&&(d=g().offset().top-120),d},m=null,f=function(){return $(".arrange")},h=function(){return null===m&&(m=f().offset().top-n),m},v=null,x=function(){return $(".evaluate")},b=function(){return null===v&&(v=x().offset().top-n),v};$(document,document.body).scroll(function(){var e=document.body.scrollTop||document.documentElement.scrollTop;e>=o()?(r().addClass("checked"),r().parent().css("padding-top","70px")):(r().removeClass("checked"),r().parent().css("padding-top","0"),r().find(".div-start").addClass("hide"));var t=r();!function(){t.find("a").each(function(){$(this).removeClass("current")})}(),e<p()?t.find(".tab_intro").addClass("current"):e<h()?t.find(".tab_chapter").addClass("current"):e<b()?t.find(".tab_teach").addClass("current"):t.find(".tab_comment").addClass("current")}),t.ajaxUtils.doGet({url:i.resolveUrl("/class/study/api"),data:{classId:e.parameter.classId}}).then(function(t){e.result=t}),e.study=function(){t.ajaxUtils.doPost({url:i.resolveUrl("/class/startStudy/api"),data:{classId:e.parameter.classId}}).then(function(t){t>0?window.location.href=gxb.settings.identifier.goLMS()+"/class/"+e.parameter.classId+"/announcement":gxb.settings.identifier.goLoginUrl()})},e.classIdData={classId:e.parameter.classId,isShow:!1},e.unauthorizedUser=function(){e.classIdData.isShow=!0},e.gostudy=function(){window.location.href=gxb.settings.identifier.goLMS()+"/class/"+e.parameter.classId+"/announcement"},e.gotoAnchor=function(e,t,i){switch(e){case"tab_intro":$(document.body).scrollTop(u()-70),document.documentElement.scrollTop=u()-70,document.body.scrollTop=u()-70;break;case"tab_chapter":$(document.body).scrollTop(p()+50),document.documentElement.scrollTop=p()+50,document.body.scrollTop=p()+50;break;case"tab_teach":$(document.body).scrollTop(h()),document.documentElement.scrollTop=h(),document.body.scrollTop=h();break;case"tab_comment":$(document.body).scrollTop(b()+120),document.documentElement.scrollTop=b()+120,document.body.scrollTop=b()+120}},e.minniClass_view=function(e){e.stopPropagation();var t=$(".chapterMain ul li span").eq(0);setTimeout(function(){angular.element(t).triggerHandler("click")},0)}}]}},e.inheritFromDir(e.uis.second_courselistDir),e.registerDependency("gxb.directives.uis.second_courselistDir",[]),e.registerDirective("gxbsecondcourselist","gxb.directives.uis.second_courselistDir",["$compile","$interval","$anchorScroll","$location","$state"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_coursexgDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_coursexg/index"),replace:!0,link:function(e,a,n){e.parameter.curPage="",e.parameter.pageSize="",e.parameter.type="related",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(a){t.ajaxUtils.doGet({url:i.resolveUrl("/tenant/current")}).then(function(t){e.relatedType=t.data.relatedType,e.$apply()}),e.data=a.dataList,e.$apply()},function(){})},controller:["$scope","$element",function(e,t){}]}},e.inheritFromDir(e.uis.second_coursexgDir),e.registerDependency("gxb.directives.uis.second_coursexgDir",[]),e.registerDirective("gxbsecondcoursexg","gxb.directives.uis.second_coursexgDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_square_categoryDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_square_category/index"),replace:!0,link:function(a,n,r){a.curPage=1,a.pageSize=4,a.newHot="new",a.searchText="",a.tab=-1,a.tab_2=-2,a.categoryId="",a.currentnew="activeRight",a.currenthot="",a.course_Less2_1="h1130",a.course_Less2_2="h1020",a.ngPaginationConfig={pageCount:1,visiblePageCount:5,prevText:"Prev",nextText:"Next",showIfOnePage:!1,currentPage:1,pagenums:[]};var s=a.$new();s.onPageChange=function(){a.fetchNews(this.currentPage,a.pageSize,a.searchText,a.newHot,a.categoryId)},a.addPaging=function(){a.ngPaginationConfig={pageCount:1,visiblePageCount:5,prevText:"Prev",nextText:"Next",showIfOnePage:!1,currentPage:1,pagenums:[]};var t="<gxbtmpagination conf='ngPaginationConfig' page-count='ngPaginationConfig.pageCount' current-page='currentPage' on-page-change='onPageChange()'></gxbtmpagination>";$("#pagination").empty(),$("#pagination").append(e.$compile(t)(a)[0]),a.$apply()},a.addPaging(),a.fetchNews=function(e,n,r,s,o){var l="class/api?curPage="+e+"&pageSize="+n+"&search="+r+"&newHot="+s+"&categoryId="+o;t.ajaxUtils.doGet({url:i.resolveUrl(l)}).then(function(e){if(a.classlist=e.dataList||[],a.total=e.paging.total,0==r.length&&0==o.length&&(a.totalqb=e.paging.total),a.ngPaginationConfig.pageCount=e.paging.totalPage,a.ngPaginationConfig.visiblePageCount=e.paging.totalPage>5?5:e.paging.totalPage,0==a.ngPaginationConfig.pagenums.length)for(var t=0;t<a.ngPaginationConfig.visiblePageCount;t++)a.ngPaginationConfig.pagenums.push(t+1);console.log(a.classlist.length),a.classlist.length<3?(a.course_Less2_1="h610",a.course_Less2_2="h520",a.no_course=!0):(a.course_Less2_1="h1130",a.course_Less2_2="h1020"),a.$apply()})},a.fetchNews(a.curPage,a.pageSize,a.searchText,a.newHot,a.categoryId),a.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,a.parameter)),a.mapper=r.mapper,a.key=r.key,t.ajaxUtils.doGet({url:a.apiUrl}).then(function(e){a.categoryslist=e.data||[],a.$apply()}),t.ajaxUtils.doGet({url:i.resolveUrl("/class/api?curPage=1&pageSize=8&search=&newHot=hot&categoryId=")}).then(function(e){a.hotclasslist=e.dataList||[],a.$apply()})},controller:["$scope","$element",function(e,t){e.allcate=function(t,i,a,n,r){r.stopPropagation(),1==a&&window.open(n),0==a&&(e.tab=i,e.tab_er=i,e.categoryId=t,e.ngPaginationConfig.pagenums=[],e.addPaging(),e.fetchNews(e.curPage,e.pageSize,e.searchText,e.newHot,e.categoryId))},e.all=function(){e.curPage=1,e.categoryId="",e.ngPaginationConfig.pagenums=[],e.addPaging(),e.fetchNews(e.curPage,e.pageSize,"","new",e.categoryId)},e.search=function(){e.ngPaginationConfig.pagenums=[],e.searchText=e.searchText,e.addPaging(),e.fetchNews(e.curPage,e.pageSize,e.searchText,e.newHot,e.categoryId)},e.myKeyup=function(t){var i=window.event?t.keyCode:t.which;13==i&&e.search()},e.newHots=function(t){e.newHot=t,"new"==t?(e.currentnew="activeRight",e.currenthot=""):(e.currentnew="",e.currenthot="activeRight"),e.ngPaginationConfig.pagenums=[],e.addPaging(),e.fetchNews(e.curPage,e.pageSize,e.searchText,e.newHot,e.categoryId)},e.onPageChange=function(){e.fetchNews(this.currentPage,e.pageSize,e.searchText,e.newHot,e.categoryId)}}]}},e.inheritFromDir(e.uis.second_square_categoryDir),e.registerDependency("gxb.directives.uis.second_square_categoryDir",[]),e.registerDirective("gxbsecondcategorys","gxb.directives.uis.second_square_categoryDir",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_square_hz=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_square_hz/index"),replace:!0,link:function(e,a,n){e.parameter.curPage="",e.parameter.pageSize="",e.parameter.type="hezuo",e.apiUrl=i.resolveUrl(t.stringUtils.format(n.api,e.parameter)),e.mapper=n.mapper,e.key=n.key,e.index_start=0,e.index_end=4,e.tab_a=1,e.aBtn_1=!1,e.aBtn_2=!1,e.aBtn_3=!1,e.parameter._index=!1,t.ajaxUtils.doGet({url:e.apiUrl}).then(function(a){t.ajaxUtils.doGet({url:i.resolveUrl("/tenant/current")}).then(function(t){e.hezuoType=t.data.hezuoType,e.$apply()}),e.coursesList=a.dataList||[],1!=e.coursesList.length&&3!=e.coursesList.length||(e.parameter._index=!0),e.coursesList.length>4&&(e.aBtn_1=!0,e.aBtn_2=!0),e.coursesList.length>8&&(e.aBtn_1=!0,e.aBtn_2=!0,e.aBtn_3=!0),e.$apply()})},controller:["$scope","$element",function(e,t){e.changeSlide=function(t,i,a){e.index_start=t,e.index_end=i,e.tab_a=a},gxb.settings.identifier.ischinayouthstartup()?e.startLearnBtn=!1:e.startLearnBtn=!0}]}},e.inheritFromDir(e.uis.second_square_hz),e.registerDependency("gxb.directives.uis.second_square_hz",[]),e.registerDirective("gxbsecondhzcourse","gxb.directives.uis.second_square_hz",["$compile","$interval"])}(gxb.directives,gxb.utils),function(e,t){e.uis.second_studyVedioDir=function(e){var i=function(e){e=e||{},this.classId=e.classId||null,this.chapterId=e.chapterId||null,this.video={uuid:e.uuid||null,title:e.title||null,file:gxb.settings.cdn.getPreviewPath(e.filePath||""),srt:gxb.settings.cdn.getPreviewPath(e.srtPath||""),cover:gxb.settings.cdn.getPreviewPath(e.coverPath||"")},this.time=e.time||0,this.localHost=e.localHost||{},this.isNormal=e.isNormal||!1,this.isPreview=e.isPreview||!1,this.height="250px",this.width="400px"},a=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/second_studyVedio/index"),replace:!0,link:function(n,r,s){gxb.settings.identifier.ischinayouthstartup()?n.chinayouthstartup=!1:n.chinayouthstartup=!0,n.apiUrl=a.resolveUrl(t.stringUtils.format(s.api,n.parameter)),n.mapper=s.mapper,n.key=s.key,t.ajaxUtils.doGet({url:n.apiUrl}).then(function(r){if(n.data=r.data,n.collectionsCount=r.data.collectionsCount,n.data.promotionalVideo){$("#videoPromotionPlayer").empty();var s="<gxbvideo data='data'></gxbvideo>",o=n.$new();o.data=new i({classId:n.parameter.classId,filePath:n.data.promotionalVideo,srtPath:n.data.promotionalVideoSrt,coverPath:n.data.courseCover||n.data.promotionalVideoCover,isPreview:!0,isNormal:!0}),$("#videoPromotionPlayer").append(e.$compile(s)(o)[0])}t.ajaxUtils.doGet({url:a.resolveUrl("/user/class/"+n.parameter.classId+"/collection/api")}).then(function(e){n.restrstatus=e.status,n.$apply()}),n.$apply(),t.ajaxUtils.doGet({url:a.resolveUrl("/class/study/api"),data:{classId:n.parameter.classId}}).then(function(e){n.result=e,n.$apply()})})},controller:["$scope","$element",function(i,n){var r={classId:i.parameter.classId};i.study=function(){t.ajaxUtils.doPost({url:a.resolveUrl("/class/startStudy/api"),data:r}).then(function(e){e>0?window.location.href=gxb.settings.identifier.goLMS()+"/class/"+i.parameter.classId+"/announcement":gxb.settings.identifier.goLoginUrl()})},gxb.settings.identifier.ischinayouthstartup()?i.isRemove=!0:i.isRemove=!1,i.classIdData={classId:i.parameter.classId,isShow:!1},i.unauthorizedUser=function(){i.classIdData.isShow=!0},i.gostudy=function(){window.location.href=gxb.settings.identifier.goLMS()+"/class/"+i.parameter.classId+"/announcement"},i.collput=function(){t.ajaxUtils.doPost({url:a.resolveUrl("/user/class/"+i.parameter.classId+"/collection/api")}).then(function(e){e.status&&(i.collectionsCount++,i.restrstatus=!0),i.$apply()})},i.colldelete=function(){t.ajaxUtils.doDelete({url:a.resolveUrl("/user/class/"+i.parameter.classId+"/collection/api")}).then(function(e){e.status&&(i.restrstatus=!1,i.collectionsCount--),i.$apply()})},i.watch_times=0,e.$classesSrv.get_watch_times(i.parameter.classId).then(function(e){i.watch_times=e.data}),i.minniClass_view=function(t){t.stopPropagation(),e.$classesSrv.watch_times(i.parameter.classId),gxb.utils.userLogUtils.operation.miniclass.sendMiniClassClickEvent({classId:i.parameter.classId});var a=$(".chapterMain ul li span").eq(0);setTimeout(function(){angular.element(a).triggerHandler("click")},5)}}]}},e.inheritFromDir(e.uis.second_studyVedioDir),e.registerDependency("gxb.directives.uis.second_studyVedioDir",[]),e.registerDirective("gxbsecondstudyvedio","gxb.directives.uis.second_studyVedioDir",["$compile","$interval","$state","gxb.services.classes.classesSrv"])}(gxb.directives,gxb.utils),function(e,t){e.uis.sencod_evaluateDir=function(e){var i=this;return{restrict:"E",templateUrl:this.resolveSecondTemplatePath("/sencod_evaluate/index"),replace:!0,link:function(a,n,r){a.ngPaginationConfig={pageCount:1,onPageChangeScrollToTop:!1,visiblePageCount:5,prevText:"Prev",nextText:"Next",showIfOnePage:!1,currentPage:1,pagenums:[]};var s="<gxbtmpagination conf='ngPaginationConfig' page-count='ngPaginationConfig.pageCount' current-page='currentPage' on-page-change='onPageChange()'></gxbtmpagination>",o=a.$new();o.onPageChange=function(){a.pageer(this.currentPage)},$("#pagination").append(e.$compile(s)(o)[0]),a.pageer=function(e){a.parameter.curPage=e,a.parameter.pageSize=5;var n=a.parameter.courseId;a.parameter.courseId=a.parameter.classId,a.apiUrl=i.resolveUrl(t.stringUtils.format(r.api,a.parameter)),a.parameter.courseId=n,t.ajaxUtils.doGet({url:a.apiUrl,cacheable:!1}).then(function(e){if(a.data=e.dataList,a.total=e.paging.total,a.ngPaginationConfig.pageCount=e.paging.totalPage,a.ngPaginationConfig.visiblePageCount=e.paging.totalPage>5?5:e.paging.totalPage,0==a.ngPaginationConfig.pagenums.length)for(var t=0;t<a.ngPaginationConfig.visiblePageCount;t++)a.ngPaginationConfig.pagenums.push(t+1);a.$apply()})},t.ajaxUtils.doGet({url:i.resolveUrl("/class/"+a.parameter.classId+"/api")}).then(function(e){a.parameter.courseId=e.data.courseId,a.avgScore=e.data.avgScore,t.ajaxUtils.doGet({url:i.resolveUrl("/evaluation/user/"+a.parameter.classId+"/api")}).then(function(e){e.status?null==e.data||""==e.data?a.subname="提交评论":(a.subname="修改",a.content=e.data.content):a.subname="提交评论"}),a.pageer(1),a.$apply()})},controller:["$scope","$element",function(e,a,n){e.ratingValue=5,e.add=function(){var a=e.content,n=e.ratingValue;if(null==a||""==a)return alert("请输入评价"),!1;var r={courseId:e.parameter.courseId,content:a,rating:n,classId:e.parameter.classId};t.ajaxUtils.doPost({url:i.resolveUrl("/evaluation/class/api"),data:r}).then(function(a){a.status?(t.ajaxUtils.doGet({url:i.resolveUrl("/evaluation/user/"+e.parameter.classId+"/api")}).then(function(t){t.status?null==t.data||""==t.data?e.subname="提交评论":(e.subname="修改",e.content=t.data.content):e.subname="提交评论"},function(){}),e.ngPaginationConfig.pagenums=[],e.pageer(1)):gxb.settings.identifier.goLoginUrl(),e.$apply()},function(e){alert(e.msg)})},e.userrating=function(a,n,r){t.ajaxUtils.doGet({url:i.resolveUrl("/evaluations/users/api"),data:{userId:n,evaluationId:r}}).then(function(s){var o={courseId:e.parameter.courseId,userrating:a,userId:n,evaluationId:r,classId:e.parameter.classId};s.status?t.ajaxUtils.doPost({url:i.resolveUrl("/evaluation/userrating/api"),data:o}).then(function(t){t.status&&(e.ngPaginationConfig.pagenums=[],e.pageer(1))}):alert("已点过赞")})}}]}},e.inheritFromDir(e.uis.sencod_evaluateDir),e.registerDependency("gxb.directives.uis.sencod_evaluateDir",[]),e.registerDirective("gxbsencodevaluate","gxb.directives.uis.sencod_evaluateDir",["$compile","$interval"])}(gxb.directives,gxb.utils);